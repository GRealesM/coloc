<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coloc: under a single causal variant assumption • coloc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Coloc: under a single causal variant assumption">
<meta property="og:description" content="coloc">
<meta property="og:image" content="http://chr1swallace.github.io/coloc/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">5.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_intro.html">Coloc: a package for colocalisation analyses</a>
    </li>
    <li>
      <a href="../articles/a02_data.html">Coloc: data structures</a>
    </li>
    <li>
      <a href="../articles/a03_enumeration.html">Coloc: under a single causal variant assumption</a>
    </li>
    <li>
      <a href="../articles/a04_sensitivity.html">Coloc: sensitivity to prior values</a>
    </li>
    <li>
      <a href="../articles/a06_SuSiE.html">Coloc: using SuSiE to relax the single causal variant assumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chr1swallace/coloc/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Coloc: under a single causal variant assumption</h1>
                        <h4 class="author">Chris Wallace</h4>
            
            <h4 class="date">2021-04-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/chr1swallace/coloc/blob/master/vignettes/a03_enumeration.Rmd"><code>vignettes/a03_enumeration.Rmd</code></a></small>
      <div class="hidden name"><code>a03_enumeration.Rmd</code></div>

    </div>

    
    
<p>vignette: &gt; % % %</p>
<div id="simulate-a-small-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#simulate-a-small-dataset" class="anchor"></a>Simulate a small dataset</h2>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu">setClass</span>(<span class="st">"simdata"</span>,
         <span class="fu">representation</span>(<span class="kw">df1</span><span class="kw">=</span><span class="st">"data.frame"</span>,<span class="kw">df2</span><span class="kw">=</span><span class="st">"data.frame"</span>))
<span class="fu">setValidity</span>(<span class="st">"simdata"</span>, <span class="kw">function</span>(<span class="no">object</span>) {
  <span class="no">n</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">object</span>@<span class="kw">df1</span>)
  <span class="kw">if</span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">object</span>@<span class="kw">df2</span>)<span class="kw">!=</span><span class="no">n</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="st">"nrow of '@df1' should equal nrow of '@df2'"</span>)
})</pre></body></html></div>
<pre><code>## Class "simdata" [in ".GlobalEnv"]
## 
## Slots:
##                             
## Name:         df1        df2
## Class: data.frame data.frame</code></pre>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu">setMethod</span>(<span class="st">"show"</span>, <span class="kw">signature</span><span class="kw">=</span><span class="st">"simdata"</span>, <span class="kw">function</span>(<span class="no">object</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"pair of simulated datasets, with"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">object</span>@<span class="kw">df1</span>)-<span class="fl">1</span>,<span class="st">"SNPs and"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">object</span>@<span class="kw">df1</span>),<span class="st">"samples.\n"</span>)
})</pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mvtnorm</span>)
<span class="no">simx</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">nsnps</span>,<span class="no">nsamples</span>,<span class="no">S</span>,<span class="no">maf</span><span class="kw">=</span><span class="fl">0.1</span>) {
    <span class="no">mu</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="no">nsnps</span>)
    <span class="no">rawvars</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html">rmvnorm</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="no">nsamples</span>, <span class="kw">mean</span><span class="kw">=</span><span class="no">mu</span>, <span class="kw">sigma</span><span class="kw">=</span><span class="no">S</span>)
    <span class="no">pvars</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">rawvars</span>)
    <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span>(<span class="fl">1</span>-<span class="no">pvars</span>, <span class="fl">2</span>, <span class="no">maf</span>)
}


<span class="no">sim.data</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">nsnps</span><span class="kw">=</span><span class="fl">50</span>,<span class="no">nsamples</span><span class="kw">=</span><span class="fl">200</span>,<span class="no">causals</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(<span class="no">nsnps</span>/<span class="fl">2</span>),<span class="no">nsim</span><span class="kw">=</span><span class="fl">1</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"Generate"</span>,<span class="no">nsim</span>,<span class="st">"small sets of data\n"</span>)
  <span class="no">ntotal</span> <span class="kw">&lt;-</span> <span class="no">nsnps</span> * <span class="no">nsamples</span> * <span class="no">nsim</span>
  <span class="no">S</span> <span class="kw">&lt;-</span> (<span class="fl">1</span> - (<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span>(<span class="fl">1</span>:<span class="no">nsnps</span>,<span class="fl">1</span>:<span class="no">nsnps</span>,<span class="no">`-`</span>))/<span class="no">nsnps</span>))^<span class="fl">4</span>
  <span class="no">X1</span> <span class="kw">&lt;-</span> <span class="fu">simx</span>(<span class="no">nsnps</span>,<span class="no">ntotal</span>,<span class="no">S</span>)
  <span class="no">X2</span> <span class="kw">&lt;-</span> <span class="fu">simx</span>(<span class="no">nsnps</span>,<span class="no">ntotal</span>,<span class="no">S</span>)
  <span class="no">Y1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">ntotal</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="no">X1</span>[,<span class="no">causals</span>,<span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>]/<span class="fl">2</span>),<span class="fl">2</span>)
  <span class="no">Y2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="no">ntotal</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="no">X2</span>[,<span class="no">causals</span>,<span class="kw">drop</span><span class="kw">=</span><span class="fl">FALSE</span>]/<span class="fl">2</span>),<span class="fl">2</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">X1</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">X2</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"s"</span>,<span class="fl">1</span>:<span class="no">nsnps</span>,<span class="kw">sep</span><span class="kw">=</span><span class="st">""</span>)
  <span class="no">df1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">Y</span><span class="kw">=</span><span class="no">Y1</span>,<span class="no">X1</span>)
  <span class="no">df2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">Y</span><span class="kw">=</span><span class="no">Y2</span>,<span class="no">X2</span>)
  <span class="kw">if</span>(<span class="no">nsim</span><span class="kw">==</span><span class="fl">1</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu">new</span>(<span class="st">"simdata"</span>,
               <span class="kw">df1</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">df1</span>),
               <span class="kw">df2</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">df2</span>)))
  } <span class="kw">else</span> {
    <span class="no">index</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span>(<span class="fl">1</span>:(<span class="no">nsamples</span> * <span class="no">nsim</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>:<span class="no">nsim</span>, <span class="no">nsamples</span>))
    <span class="no">objects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="no">index</span>, <span class="kw">function</span>(<span class="no">i</span>) <span class="fu">new</span>(<span class="st">"simdata"</span>, <span class="kw">df1</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">df1</span>[<span class="no">i</span>,]),
                                             <span class="kw">df2</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">df2</span>[<span class="no">i</span>,])))
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">objects</span>)
  }
}

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">46411</span>)
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu">sim.data</span>()</pre></body></html></div>
<pre><code>## Generate 1 small sets of data</code></pre>
</div>
<div id="fine-mapping-under-a-single-causal-variant-assumption" class="section level1">
<h1 class="hasAnchor">
<a href="#fine-mapping-under-a-single-causal-variant-assumption" class="anchor"></a>Fine mapping under a single causal variant assumption</h1>
<p>The Approximate Bayes Factor colocalisation analysis described in the next section essentially works by fine mapping each trait under a single causal variant assumption and then integrating over those two posterior distributions to calculate probabilities that those variants are shared. Of course, this means we can look at each trait on its own quite simply, and we can do that with the function <code>finemap.abf</code>.</p>
<p>First we load some simulated data. See <a href="a02_data.html">the data vignette</a> to understand how to format your datasets.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">coloc</span>)</pre></body></html></div>
<pre><code>## This is a new update to coloc.</code></pre>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">coloc_test_data</span>)
<span class="fu"><a href="https://rdrr.io/r/base/attach.html">attach</a></span>(<span class="no">coloc_test_data</span>)</pre></body></html></div>
<p>Then we analyse the statistics from a single study, asking about the evidence that each SNP in turn is solely causal for any association signal we see. As we might expect, that evidence is maximised at the SNP with the smallest p value</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_dataset.html">plot_dataset</a></span>(<span class="no">D1</span>)</pre></body></html></div>
<p><img src="a03_enumeration_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">my.res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/finemap.abf.html">finemap.abf</a></span>(<span class="kw">dataset</span><span class="kw">=</span><span class="no">D1</span>)
<span class="no">my.res</span>[<span class="fl">21</span>:<span class="fl">30</span>,]</pre></body></html></div>
<pre><code>##              V.       z.        r.       lABF. snp position prior       SNP.PP
## s21 0.018382750 2.134434 0.6983820  0.99154985 s21       21 1e-04 4.682012e-06
## s22 0.034439795 2.522096 0.5527542  1.35570279 s22       22 1e-04 6.738793e-06
## s23 0.019899615 2.041965 0.6814226  0.84869249 s23       23 1e-04 4.058732e-06
## s24 0.038248005 2.079800 0.5267061  0.76513252 s24       24 1e-04 3.733367e-06
## s25 0.007464217 4.027523 0.8508010  5.94915946 s25       25 1e-04 6.660318e-04
## s26 0.044959037 1.146038 0.4863199 -0.01371031 s26       26 1e-04 1.713379e-06
## s27 0.045794693 2.201098 0.4817205  0.83830739 s27       27 1e-04 4.016799e-06
## s28 0.016456259 2.077413 0.7211779  0.91758247 s28       28 1e-04 4.348194e-06
## s29 0.013113047 2.181412 0.7644818  1.09593176 s29       29 1e-04 5.197147e-06
## s30 0.011002838 2.494244 0.7945975  1.68030511 s30       30 1e-04 9.322988e-06</code></pre>
<p>The <code>SNP.PP</code> column shows the posterior probability that exactly that SNP is causal. Note the last line in this data.frame does not correspond to a SNP, but to the null model, that no SNP is causal.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="no">my.res</span>,<span class="fl">3</span>)</pre></body></html></div>
<p>Finally, if you do have full genotype data as here, while this is a fast method for fine mapping, it can be sensible to consider multiple causal variant models too. One package that allows you to do this is <a href="http://github.com/chr1swallace/GUESSFM">GUESSFM</a>, described in<sup><a id="fnr.5" class="footref" href="#fn.5">5</a></sup></p>
<p><a id="org6973f37"></a></p>
</div>
<div id="approximate-bayes-factor-colocalisation-analyses" class="section level1">
<h1 class="hasAnchor">
<a href="#approximate-bayes-factor-colocalisation-analyses" class="anchor"></a>(Approximate) Bayes Factor colocalisation analyses</h1>
<p><a id="org192e16b"></a></p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The idea behind the ABF analysis is that the association of each trait with SNPs in a region may be summarised by a vector of 0s and at most a single 1, with the 1 indicating the causal SNP (so, assuming a single causal SNP for each trait). The posterior probability of each possible configuration can be calculated and so, crucially, can the posterior probabilities that the traits share their configurations. This allows us to estimate the support for the following cases:</p>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: neither trait has a genetic association in the region</li>
<li>
<span class="math inline">\(H_1\)</span>: only trait 1 has a genetic association in the region</li>
<li>
<span class="math inline">\(H_2\)</span>: only trait 2 has a genetic association in the region</li>
<li>
<span class="math inline">\(H_3\)</span>: both traits are associated, but with different causal variants</li>
<li>
<span class="math inline">\(H_4\)</span>: both traits are associated and share a single causal variant</li>
</ul>
<p><a id="orgb0fa807"></a></p>
</div>
<div id="the-basic-coloc-abf-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-basic-coloc-abf-function" class="anchor"></a>The basic <code>coloc.abf</code> function</h2>
<p>The function <code>coloc.abf</code> is ideally suited to the case when only summary data are available.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">my.res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/coloc.abf.html">coloc.abf</a></span>(<span class="kw">dataset1</span><span class="kw">=</span><span class="no">D1</span>,
                    <span class="kw">dataset2</span><span class="kw">=</span><span class="no">D2</span>)</pre></body></html></div>
<pre><code>## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf 
##  6.34e-07  3.59e-05  1.94e-05  9.72e-05  1.00e+00 
## [1] "PP abf for shared variant: 100%"</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">my.res</span>)</pre></body></html></div>
<pre><code>## Coloc analysis of trait 1, trait 2</code></pre>
<pre><code>## 
## SNP Priors</code></pre>
<pre><code>##    p1    p2   p12 
## 1e-04 1e-04 1e-05</code></pre>
<pre><code>## 
## Hypothesis Priors</code></pre>
<pre><code>##         H0    H1    H2       H3    H4
##  0.9894755 0.005 0.005 2.45e-05 5e-04</code></pre>
<pre><code>## 
## Posterior</code></pre>
<pre><code>##        nsnps           H0           H1           H2           H3           H4 
## 5.000000e+01 6.340607e-07 3.587164e-05 1.939055e-05 9.716316e-05 9.998469e-01</code></pre>
<p>Note that if you do find strong evidence for H4, we can extract the posterior probabilities for each SNP to be causal <em>conditional on H4 being true</em>. This is part of the calculation required by coloc, and contained in the column SNP.PP.H4 in the “results” element of the returned list. So we can extract the more likely causal variants by</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">my.res</span>$<span class="no">results</span>,<span class="no">SNP.PP.H4</span><span class="kw">&gt;</span><span class="fl">0.01</span>)</pre></body></html></div>
<pre><code>##   snp position       V.df1    z.df1     r.df1 lABF.df1       V.df2    z.df2
## 5 s13       13 0.007335407 5.756249 0.8529972 13.17313 0.006483471 5.643536
##       r.df2 lABF.df2 internal.sum.lABF SNP.PP.H4
## 5 0.8518436 12.61065          25.78378  0.999884</code></pre>
<p>or the 95% credible set by</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">o</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">my.res</span>$<span class="no">results</span>$<span class="no">SNP.PP.H4</span>,<span class="kw">decreasing</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="no">cs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span>(<span class="no">my.res</span>$<span class="no">results</span>$<span class="no">SNP.PP.H4</span>[<span class="no">o</span>])
<span class="no">w</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">cs</span> <span class="kw">&gt;</span> <span class="fl">0.95</span>)[<span class="fl">1</span>]
<span class="no">my.res</span>$<span class="no">results</span>[<span class="no">o</span>,][<span class="fl">1</span>:<span class="no">w</span>,]$<span class="no">snp</span></pre></body></html></div>
<pre><code>## [1] "s13"</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Chris Wallace, Claudia Giambartolomei.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
